plot(st_make_grid(cartogram, cellsize = 100, square = FALSE))
plot(st_make_grid(cartogram, cellsize = 1000, square = FALSE))
plot(st_make_grid(cartogram, cellsize = 2000, square = FALSE))
grid = st_make_grid(cartogram, cellsize = 2000, square = FALSE)
View(grid)
st_centroid(grid)
ctr = st_centroid(grid)
View(ctr)
st_intersects(ctr, cartogram, sparse = TRUE, ...)
st_intersects(ctr, cartogram, sparse = TRUE)
test = st_intersects(ctr, cartogram, sparse = TRUE)
View(test)
test = st_intersects(ctr, cartogram, sparse = FALSE)
View(test)
test = st_intersects(ctr, cartogram, sparse = TRUE)
data.frame(test)
test = data.frame(test)
View(test)
st_join(ctr, cartogram, left = FALSE)
View(test)
test = st_intersects(ctr, cartogram, sparse = TRUE, prepared = TRUE)
View(test)
test = st_intersects(ctr, cartogram, sparse = TRUE, prepared = FALSE)
View(test)
test = st_intersects(ctr, cartogram, sparse = FALSE, prepared = FALSE)
View(test)
test = st_intersects(ctr, cartogram, sparse = FALSE, prepared = FALSE)
View(test)
test = st_intersects(ctr, cartogram, sparse = FALSE, prepared = FALSE)
View(test)
test = st_intersects(ctr, cartogram, sparse = TRUE, prepared = FALSE)
View(test)
test = data.frame(test)
View(test)
test = st_within(x = ctr, y = cartogram, sparse = TRUE, prepared = TRUE)
View(test)
data.frame(test)
View(data.frame(test))
ctr[1]
st_within(x = ctr[1], y = cartogram, sparse = TRUE, prepared = TRUE)
st_within(x = ctr[2], y = cartogram, sparse = TRUE, prepared = TRUE)
st_within(x = ctr[100], y = cartogram, sparse = TRUE, prepared = TRUE)
st_within(x = ctr[500], y = cartogram, sparse = TRUE, prepared = TRUE)
row.names(ctr)
row.names(ctr)
class(ctr)
length(ctr)
d <- data.frame(matrix(, nrow=length(ctr), ncol=0))
d
View(d)
st_sf(id = 1:length(ctr), geometry = ctr)
grid = st_make_grid(cartogram, cellsize = 2000, square = FALSE)
grid = st_sf(id = 1:length(ctr), geometry = grid)
ctr = st_centroid(grid)
View(ctr)
plot(st_geometry(ctr))
plot(st_geometry(grid))
test = st_within(x = ctr, y = cartogram, sparse = TRUE, prepared = TRUE)
View(test)
View(data.frame(test))
for(i in 1:length(ctr)){
tmp = st_within(x = ctr[i], y = cartogram, sparse = TRUE, prepared = TRUE)
if (i == 1){output = tmp} else {output = rbind(output, tmp)}
}
View(output)
for(i in 1:length(ctr)){
tmp = st_within(x = ctr[i], y = cartogram, sparse = TRUE, prepared = TRUE)
if (i == 1){output = tmp} else {output = cbind(output, tmp)}
}
View(output)
st_within(x = ctr[1000], y = cartogram, sparse = TRUE, prepared = TRUE)
st_within(x = ctr[100], y = cartogram, sparse = TRUE, prepared = TRUE)
ctr
ctr[,100]
ctr[100,]
for(i in 1:length(ctr)){
tmp = st_within(x = ctr[,i], y = cartogram, sparse = TRUE, prepared = TRUE)
if (i == 1){output = tmp} else {output = cbind(output, tmp)}
}
View(output)
st_within(x = ctr[,100], y = cartogram, sparse = TRUE, prepared = TRUE)
ctr[,100]
for(i in 1:length(ctr)){
tmp = st_within(x = ctr[i,], y = cartogram, sparse = TRUE, prepared = TRUE)
if (i == 1){output = tmp} else {output = cbind(output, tmp)}
}
View(output)
for(i in 1:length(ctr)){
tmp = st_within(x = ctr[i,], y = cartogram, sparse = TRUE, prepared = TRUE)
if (i == 1){output = tmp} else {output = rbind(output, tmp)}
}
View(output)
st_within(x = ctr[100,], y = cartogram, sparse = TRUE, prepared = TRUE)
st_within(x = ctr[1000,], y = cartogram, sparse = TRUE, prepared = TRUE)
st_within(x = ctr[1200,], y = cartogram, sparse = TRUE, prepared = TRUE)
x = st_within(x = ctr[1200,], y = cartogram, sparse = TRUE, prepared = TRUE)
class(x)
as.numeric(class(x))
x = st_within(x = ctr[1200,], y = cartogram, sparse = TRUE, prepared = TRUE)
x
class(x)
unlist(x)
i = 1200
x = st_within(x = ctr[i,], y = cartogram, sparse = TRUE, prepared = TRUE)
x = st_within(x = ctr[i,], y = cartogram, sparse = TRUE, prepared = TRUE)
unlist(x)
plot(st_geometry(grid), col ="#CCC")
plot(st_geometry(grid), col ="#CCCCCC")
plot(st_geometry(grid[i,]), col ="red", add= TRUE)
plot(st_geometry(cartogram[unlist(x),]), col ="green", add= TRUE)
plot(st_geometry(grid), col ="#CCCCCC")
plot(st_geometry(cartogram[unlist(x),]), col ="green", add= TRUE)
plot(st_geometry(grid[i,]), col ="red", add= TRUE)
i = 2200
x = st_within(x = ctr[i,], y = cartogram, sparse = TRUE, prepared = TRUE)
plot(st_geometry(grid), col ="#CCCCCC")
plot(st_geometry(cartogram[unlist(x),]), col ="green", add= TRUE)
plot(st_geometry(grid[i,]), col ="red", add= TRUE)
artogram[unlist(x),"id"]
cartogram[unlist(x),"id"]
cartogram[unlist(x),"id"] %>% st_drop_geometry()
i = 1
x = st_within(x = ctr[i,], y = cartogram, sparse = TRUE, prepared = TRUE)
plot(st_geometry(grid), col ="#CCCCCC")
plot(st_geometry(cartogram[unlist(x),]), col ="green", add= TRUE)
plot(st_geometry(grid[i,]), col ="red", add= TRUE)
unlist(x)
id = cartogram[unlist(x),"id"] %>% st_drop_geometry()
id
grid = st_make_grid(cartogram, cellsize = 2000, square = FALSE)
grid = st_sf(id = 1:length(ctr), geometry = grid)
ctr = st_centroid(grid)
View(grid)
grid = st_make_grid(cartogram, cellsize = 2000, square = FALSE)
grid = st_sf(id = 1:length(ctr), geometry = grid)
View(grid)
grid = st_sf(id = NA, geometry = grid)
rep(1:length(ctr),NA)
rep(NA,length(ctr))
grid = st_make_grid(cartogram, cellsize = 2000, square = FALSE)
grid = st_sf(id = rep(NA,length(ctr)), geometry = grid)
ctr = st_centroid(grid)
View(grid)
library("sf")
library("mapsf")
cartogram = st_read("files/GastnerSeguy.gpkg")
mf_map(cartogram)
View(cartogram)
grid = st_make_grid(cartogram, cellsize = 2000, square = FALSE)
grid = st_sf(id = rep(NA,length(ctr)), geometry = grid)
for(i in 1:length(ctr)){
x = st_within(x = st_centroid(grid)[i,], y = cartogram, sparse = TRUE, prepared = TRUE)
grid$id = cartogram[unlist(x),"id"] %>% st_drop_geometry()
}
library("sf")
library("mapsf")
cartogram = st_read("files/GastnerSeguy.gpkg")
grid = st_make_grid(cartogram, cellsize = 2000, square = FALSE)
grid = st_sf(id = rep(NA,length(ctr)), geometry = grid)
grid = st_sf(id = rep(NA,length(grid)), geometry = grid)
for(i in 1:length(ctr)){
x = st_within(x = st_centroid(grid)[i,], y = cartogram, sparse = TRUE, prepared = TRUE)
grid$id = cartogram[unlist(x),"id"] %>% st_drop_geometry()
}
library("sf")
library("mapsf")
cartogram = st_read("files/GastnerSeguy.gpkg")
grid = st_make_grid(cartogram, cellsize = 2000, square = FALSE)
grid = st_sf(id = rep(NA,length(grid)), geometry = grid)
for(i in 1:length(ctr)){
x = st_within(x = st_centroid(grid)[i,], y = cartogram, sparse = TRUE, prepared = TRUE)
grid$id[i] = cartogram[unlist(x),"id"] %>% st_drop_geometry()
}
View(grid)
grid <- grid[!is.na(grid$id),]
View(grid)
i = 1
grid$id[i]
i = 100
grid$id[i]
grid[i,"id"]
library("sf")
library("mapsf")
cartogram = st_read("files/GastnerSeguy.gpkg")
grid = st_make_grid(cartogram, cellsize = 2000, square = FALSE)
grid = st_sf(id = rep(NA,length(grid)), geometry = grid)
for(i in 1:length(ctr)){
x = st_within(x = st_centroid(grid)[i,], y = cartogram, sparse = TRUE, prepared = TRUE)
grid[i,"id"] = cartogram[unlist(x),"id"] %>% st_drop_geometry()
}
View(grid)
grid <- grid[!is.na(grid$id),]
View(grid)
i = 1200
x = st_within(x = st_centroid(grid)[i,], y = cartogram, sparse = TRUE, prepared = TRUE)
View(x)
ctr
ctr = st_centroid(grid)
ctr
library("sf")
library("mapsf")
cartogram = st_read("files/GastnerSeguy.gpkg")
grid = st_make_grid(cartogram, cellsize = 2000, square = FALSE)
grid = st_sf(id = rep(NA,length(grid)), geometry = grid)
ctr = st_centroid(grid)
ctr
library("sf")
library("mapsf")
cartogram = st_read("files/GastnerSeguy.gpkg")
grid = st_make_grid(cartogram, cellsize = 2000, square = FALSE)
grid = st_sf(id = rep(NA,length(grid)), geometry = grid)
ctr = st_centroid(grid)
for(i in 1:length(grid)){
x = st_within(x = ctr[i,], y = cartogram, sparse = TRUE, prepared = TRUE)
grid[i,"id"] = cartogram[unlist(x),"id"] %>% st_drop_geometry()
}
grid <- grid[!is.na(grid$id),]
View(grid)
i = 1200
x = st_within(x = ctr[i,], y = cartogram, sparse = TRUE, prepared = TRUE)
x
cartogram[unlist(x),"id"]
cartogram[unlist(x),"id"] %>% st_drop_geometry()
as.character(artogram[unlist(x),"id"] %>% st_drop_geometry()=
as.character(artogram[unlist(x),"id"] %>% st_drop_geometry())
as.character(cartogram[unlist(x),"id"] %>% st_drop_geometry())
as.character(cartogram[unlist(x),"id"])
as.character(cartogram[unlist(x),"id"] %>% st_drop_geometry())
ids = cartogram[unlist(x),"id"] %>% st_drop_geometry()
ids
ids = cartogram[,"id"] %>% st_drop_geometry()
ids
ids[x]
x
ids[unlist(x)]
unlist(x)
ids
ids[,x]
ids[x,]
ids[x]
x
ids[unlist(x)]
ids = as.vector(cartogram[,"id"] %>% st_drop_geometry())
ids
ids[unlist(x)]
ids[1]
ids[2]
ids[,1]
ids[1,]
ids = cartogram[,"id"] %>% st_drop_geometry()
library("sf")
library("mapsf")
cartogram = st_read("files/GastnerSeguy.gpkg")
grid = st_make_grid(cartogram, cellsize = 2000, square = FALSE)
grid = st_sf(id = rep(NA,length(grid)), geometry = grid)
ctr = st_centroid(grid)
ids = cartogram[,"id"] %>% st_drop_geometry()
i = 1200
x = st_within(x = ctr[i,], y = cartogram, sparse = TRUE, prepared = TRUE)
ids[unlist(x),]
library("sf")
library("mapsf")
cartogram = st_read("files/GastnerSeguy.gpkg")
grid = st_make_grid(cartogram, cellsize = 2000, square = FALSE)
grid = st_sf(id = rep(NA,length(grid)), geometry = grid)
ctr = st_centroid(grid)
ids = cartogram[,"id"] %>% st_drop_geometry()
for(i in 1:length(grid)){
x = st_within(x = ctr[i,], y = cartogram, sparse = TRUE, prepared = TRUE)
grid[i,"id"] = ids[unlist(x),]
}
View(grid)
library("sf")
library("mapsf")
cartogram = st_read("files/GastnerSeguy.gpkg")
grid = st_make_grid(cartogram, cellsize = 2000, square = FALSE)
grid = st_sf(id = rep(NA,length(grid)), geometry = grid)
ctr = st_centroid(grid)
ids = cartogram[,"id"] %>% st_drop_geometry()
for(i in 1:length(grid)){
x = st_within(x = ctr[i,], y = cartogram, sparse = TRUE, prepared = TRUE)
#grid[i,"id"] = ids[unlist(x),]
}
library("sf")
library("mapsf")
cartogram = st_read("files/GastnerSeguy.gpkg")
grid = st_make_grid(cartogram, cellsize = 2000, square = FALSE)
grid = st_sf(id = rep(NA,length(grid)), geometry = grid)
ctr = st_centroid(grid)
ids = cartogram[,"id"] %>% st_drop_geometry()
for(i in 1:length(grid)){
x = st_within(x = ctr[i,], y = cartogram, sparse = TRUE, prepared = TRUE)
grid[i,"id"] = ids[unlist(x),]
}
i = 1
x = st_within(x = ctr[i,], y = cartogram, sparse = TRUE, prepared = TRUE)
x
ids[unlist(x),]
grid[i,"id"] = ids[unlist(x),]
ids[unlist(x),]
id = ids[unlist(x),]
length(id)
library("sf")
library("mapsf")
cartogram = st_read("files/GastnerSeguy.gpkg")
grid = st_make_grid(cartogram, cellsize = 2000, square = FALSE)
grid = st_sf(id = rep(NA,length(grid)), geometry = grid)
ctr = st_centroid(grid)
ids = cartogram[,"id"] %>% st_drop_geometry()
for(i in 1:length(grid)){
x = st_within(x = ctr[i,], y = cartogram, sparse = TRUE, prepared = TRUE)
id = ids[unlist(x),]
if (length(id) == 0){id = NA}
grid[i,"id"] = id
}
View(grid)
grid <- grid[!is.na(grid$id),]
View(grid)
summary(grid$id)
grid$id
class(grid)
class(grid$id)
library("sf")
library("mapsf")
cartogram = st_read("files/GastnerSeguy.gpkg")
grid = st_make_grid(cartogram, cellsize = 2000, square = FALSE)
grid = st_sf(id = rep(NULL,length(grid)), geometry = grid)
ctr = st_centroid(grid)
ids = cartogram[,"id"] %>% st_drop_geometry()
for(i in 1:length(grid)){
x = st_within(x = ctr[i,], y = cartogram, sparse = TRUE, prepared = TRUE)
id = ids[unlist(x),]
if (length(id) == 0){id = NA}
grid[i,"id"] = id
}
summary(grid$id)
class(grid$id)
library("sf")
library("mapsf")
cartogram = st_read("files/GastnerSeguy.gpkg")
grid = st_make_grid(cartogram, cellsize = 2000, square = FALSE)
grid = st_sf(id = rep(0,length(grid)), geometry = grid)
View(grid)
ctr = st_centroid(grid)
ids = cartogram[,"id"] %>% st_drop_geometry()
for(i in 1:length(grid)){
x = st_within(x = ctr[i,], y = cartogram, sparse = TRUE, prepared = TRUE)
id = ids[unlist(x),]
if (length(id) == 0){id = NA}
grid[i,"id"] = id
}
View(grid)
grid <- grid[!is.na(grid$id),]
View(grid)
i = 1200
x = st_within(x = ctr[i,], y = cartogram, sparse = TRUE, prepared = TRUE)
View(x)
id = ids[unlist(x),]
id
grid[i]
grid[,i]
grid[i,]
grid[i,"id"] =
View(grid)
grid[i,"id"]
grid[i,"id"] = 10
grid[i,"id"]
grid[i,"id"] = id
View(grid)
grid[i,"id"]
library("sf")
library("mapsf")
cartogram = st_read("files/GastnerSeguy.gpkg")
grid = st_make_grid(cartogram, cellsize = 2000, square = FALSE)
grid = st_sf(id = rep("",length(grid)), geometry = grid)
View(grid)
ctr = st_centroid(grid)
ids = cartogram[,"id"] %>% st_drop_geometry()
for(i in 1:length(grid)){
x = st_within(x = ctr[i,], y = cartogram, sparse = TRUE, prepared = TRUE)
id = ids[unlist(x),]
if (length(id) == 0){id = NA}
grid[i,"id"] = id
}
library("sf")
library("mapsf")
cartogram = st_read("files/GastnerSeguy.gpkg")
grid = st_make_grid(cartogram, cellsize = 2000, square = FALSE)
grid = st_sf(id = rep("",length(grid)), geometry = grid)
View(grid)
ctr = st_centroid(grid)
ids = cartogram[,"id"] %>% st_drop_geometry()
for(i in 1:length(grid)){
x = st_within(x = ctr[i,], y = cartogram, sparse = TRUE, prepared = TRUE)
id = ids[unlist(x),]
if (length(id) == 0){id = NA}
grid[i,"id"] = id
}
grid[1200,]
library("sf")
library("mapsf")
cartogram = st_read("files/GastnerSeguy.gpkg")
grid = st_make_grid(cartogram, cellsize = 2000, square = FALSE)
grid = st_sf(id = rep("",length(grid)), geometry = grid)
View(grid)
ctr = st_centroid(grid)
ids = cartogram[,"id"] %>% st_drop_geometry()
for(i in 1:length(grid)){
x = st_within(x = ctr[i,], y = cartogram, sparse = TRUE, prepared = TRUE)
id = ids[unlist(x),]
if (length(id) == 0){id = "ZOB"}
grid[i,"id"] = id
}
library("sf")
library("mapsf")
cartogram = st_read("files/GastnerSeguy.gpkg")
grid = st_make_grid(cartogram, cellsize = 2000, square = FALSE)
grid = st_sf(id = rep("",length(grid)), geometry = grid)
View(grid)
ctr = st_centroid(grid)
ids = cartogram[,"id"] %>% st_drop_geometry()
for(i in 1:length(grid)){
x = st_within(x = ctr[i,], y = cartogram, sparse = TRUE, prepared = TRUE)
id = ids[unlist(x),]
#if (length(id) == 0){id = "ZOB"}
grid[i,"id"] = id
}
library("sf")
library("mapsf")
cartogram = st_read("files/GastnerSeguy.gpkg")
grid = st_make_grid(cartogram, cellsize = 2000, square = FALSE)
grid = st_sf(id = rep("",length(grid)), geometry = grid)
View(grid)
ctr = st_centroid(grid)
ids = cartogram[,"id"] %>% st_drop_geometry()
for(i in 1:length(grid)){
x = st_within(x = ctr[i,], y = cartogram, sparse = TRUE, prepared = TRUE)
id = ids[unlist(x),]
if (length(id) == 0){id = "ZOB"}
grid[i,"id"] = "test"
}
ength(grid)
length(grid)
length(grid$id)
nrows(grid)
n_rows(grid)
nrow(grid)
library("sf")
library("mapsf")
cartogram = st_read("files/GastnerSeguy.gpkg")
grid = st_make_grid(cartogram, cellsize = 2000, square = FALSE)
grid = st_sf(id = rep("",length(grid)), geometry = grid)
View(grid)
ctr = st_centroid(grid)
ids = cartogram[,"id"] %>% st_drop_geometry()
for(i in 1:nrow(grid)){
x = st_within(x = ctr[i,], y = cartogram, sparse = TRUE, prepared = TRUE)
id = ids[unlist(x),]
if (length(id) == 0){id = "ZOB"}
grid[i,"id"] = id
}
library("sf")
library("mapsf")
cartogram = st_read("files/GastnerSeguy.gpkg")
grid = st_make_grid(cartogram, cellsize = 2000, square = FALSE)
grid = st_sf(id = rep("",length(grid)), geometry = grid)
ctr = st_centroid(grid)
ids = cartogram[,"id"] %>% st_drop_geometry()
for(i in 1:nrow(grid)){
x = st_within(x = ctr[i,], y = cartogram, sparse = TRUE, prepared = TRUE)
id = ids[unlist(x),]
if (length(id) == 0){id = NA}
grid[i,"id"] = id
}
i = 1200
x = st_within(x = ctr[i,], y = cartogram, sparse = TRUE, prepared = TRUE)
id = ids[unlist(x),]
id
id = ids[unlist(x),][1]
id
library("sf")
library("mapsf")
cartogram = st_read("files/GastnerSeguy.gpkg")
grid = st_make_grid(cartogram, cellsize = 2000, square = FALSE)
grid = st_sf(id = rep("",length(grid)), geometry = grid)
ctr = st_centroid(grid)
ids = cartogram[,"id"] %>% st_drop_geometry()
for(i in 1:nrow(grid)){
x = st_within(x = ctr[i,], y = cartogram, sparse = TRUE, prepared = TRUE)
id = ids[unlist(x),][1]
if (length(id) == 0){id = NA}
grid[i,"id"] = id
}
View(grid)
grid <- grid[!is.na(grid$id),]
plot(st_geometry(grid))
aggregate(
x = grid, by = id
)
aggregate(x = grid, by = id,min)
aggregate(x = grid, by = "id",min)
aggregate(x = grid, by = c("id"),min)
aggregate(x = grid, by = list("id"),min)
aggregate(x = grid, by = list("id"),mean)
x <- aggregate(x = grid,
by = list(grid$id),
FUN = first)
x <- aggregate(x = grid,
by = list(grid$id),
FUN = min)
View(x)
plot(st_geometry(x))
